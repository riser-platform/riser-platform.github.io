<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="GitOps #  Riser is built on the principles of GitOps. Every change that Riser makes happens via a State Repo, a Git repository which holds a versioned account of all Kubernetes state. Whenever you issue a command in Riser (e.g. to make a Deployment), Riser makes a commit to the State Repo with the desired changes on your behalf. Each Kubernetes cluster watches for changes in the GitOps repo and applies those changes on a continuous basis."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="GitOps #  Riser is built on the principles of GitOps. Every change that Riser makes happens via a State Repo, a Git repository which holds a versioned account of all Kubernetes state. Whenever you issue a command in Riser (e.g. to make a Deployment), Riser makes a commit to the State Repo with the desired changes on your behalf. Each Kubernetes cluster watches for changes in the GitOps repo and applies those changes on a continuous basis."><meta property="og:type" content="article"><meta property="og:url" content="https://docs.riser.dev/docs/internals/gitops/"><meta property="article:modified_time" content="2021-04-27T14:44:32+02:00"><title>Gitops | Riser Platform</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY="><script defer src=/en.search.min.839d9871cad346e074eb8cc34cbfb6c7d08f8cdeac7d50a1c61ccca3bd9dbf29.js integrity="sha256-g52YccrTRuB064zDTL+2x9CPjN6sfVChxhzMo72dvyk="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><img src=/logo.png alt=Logo><span>Riser Platform</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/quickstart/>Quickstart</a><ul></ul></li><li><span>Concepts</span><ul><li><a href=/docs/concepts/apps/>Apps</a></li><li><a href=/docs/concepts/deployments/>Deployments</a></li><li><a href=/docs/concepts/environments/>Environments</a></li><li><a href=/docs/concepts/namespaces/>Namespaces</a></li><li><a href=/docs/concepts/runtime/>Runtime</a></li><li><a href=/docs/concepts/secrets/>Secrets</a></li><li><a href=/docs/concepts/url_routing/>Url Routing</a></li></ul></li><li><span>Guidance</span><ul><li><a href=/docs/guidance/docker/>Docker</a></li></ul></li><li><a href=/docs/internals/>Internals</a><ul><li><a href=/docs/internals/gitops/ class=active>Gitops</a></li><li><a href=/docs/internals/secrets/>Secrets</a></li></ul></li><li><a href=/docs/operations/>Operations</a><ul></ul></li></ul><ul><li><a href=https://github.com/riser-platform/riser target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Gitops</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#the-state-repo>The State Repo</a><ul><li><a href=#environments-and-branches>Environments and Branches</a></li><li><a href=#folder-structure>Folder Structure</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=gitops>GitOps
<a class=anchor href=#gitops>#</a></h1><p>Riser is built on the <a href=https://www.weave.works/technologies/gitops/>principles of GitOps</a>. Every change that Riser makes happens via a <em>State Repo</em>, a Git repository which holds a versioned account of all Kubernetes state. Whenever you issue a command in Riser (e.g. to make a <a href=/docs/concepts/deployments/>Deployment</a>), Riser makes a commit to the <em>State Repo</em> with the desired changes on your behalf. Each Kubernetes cluster watches for changes in the GitOps repo and applies those changes on a continuous basis.</p><blockquote class="book-hint info">ℹ️ <em>You do not need to interact with the State Repo as part of normal Riser operations. The State Repo is useful for auditing (e.g. who changed what and when) and for debugging (e.g. what is the current state of my Deployment)</em></blockquote><h2 id=the-state-repo>The State Repo
<a class=anchor href=#the-state-repo>#</a></h2><h3 id=environments-and-branches>Environments and Branches
<a class=anchor href=#environments-and-branches>#</a></h3><p>Each <em>Environment</em> gets their own branch in the <em>State Repo</em>. The branch name is the same as the <em>Environment</em> name. For example, if you create an <em>Environment</em> named &ldquo;dev&rdquo;, Riser will create a branch named &ldquo;dev&rdquo; in the <em>State Repo</em>.</p><h3 id=folder-structure>Folder Structure
<a class=anchor href=#folder-structure>#</a></h3><p>Riser manages the folder structure of the <em>State Repo</em>. This section is useful to help you navigate the <em>State Repo</em> for auditing or debugging purposes, or if you wish to use the <em>State Repo</em> for Kubernetes state that is not managed by Riser.</p><blockquote class="book-hint warning">⚠️ <em>Riser is the source of truth for all resources managed by Riser. Riser makes no attempt to merge any changes with Riser&rsquo;s desired state and the state of the repo. Do not manually modify any Riser managed resources in the State Repo.</em></blockquote><h4 id=annotated-example>Annotated Example
<a class=anchor href=#annotated-example>#</a></h4><p>The following is an example of a <em>State Repo</em> with an <em>App</em> with a <em>Deployment</em> named &ldquo;testdummy&rdquo; in the &ldquo;apps&rdquo; namespace.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>├── riser-config <span style=color:#75715e># &lt;- Configuration used to generate the state. This folder exists for auditing and debugging purposes</span>
│    ├── apps <span style=color:#75715e># &lt;- The namespace</span>
│    │    └── testdummy.yaml <span style=color:#75715e># &lt;- The App config for &#34;testdummy&#34;</span>
└── state <span style=color:#75715e># &lt;- Kubernetes state goes here</span>
     ├── riser-managed <span style=color:#75715e># &lt;- Resources that are managed by Riser.</span>
     │    ├── apps <span style=color:#75715e># &lt;- The namespace</span>
     │    │    ├── deployments <span style=color:#75715e># &lt;- deployment resources</span>
     │    │    │    ├── testdummy <span style=color:#75715e># &lt;- The deployment name</span>
     │    │    │    │    └── ...*.yaml <span style=color:#75715e># &lt;- One or more deployment resource files</span>
     │    │    └── secrets <span style=color:#75715e># &lt;- App encrypted secrets</span>
     │    │         └── testdummy <span style=color:#75715e># &lt;- The app name</span>
     │    │               └── ...*.yaml <span style=color:#75715e># &lt;- One or more secret resource files</span>
     │    └── namespace.apps.yaml <span style=color:#75715e># &lt;- The namespace ya</span>
     └── ??? <span style=color:#75715e># &lt;- You may create your own folders for managing non Riser k8s resources if you wish</span>
</code></pre></div><h4 id=riser-config>riser-config
<a class=anchor href=#riser-config>#</a></h4><p>The top level <code>riser-config</code> folder is a top level folder that contains all configuration used to generate Kubernetes state for each <em>App</em>, and for each <em>Deployment</em> . It contains the final configuration used with any overrides applied. This folder is only used for auditing and debugging purposes. It makes it easy to observe what changes happened over time. It also makes it trivial to compare differences between <em>Environments</em>.</p><h4 id=state>state
<a class=anchor href=#state>#</a></h4><p>The top level <code>state</code> folder contains all resources that represent state in Kubernetes. The <code>riser-managed</code> folder contains resources that are strictly managed by Riser. You should treat this as a <em>read only</em> folder. If you have other resources that you would also like to manage via GitOps, you may create sibling folders.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/riserplatform/docs/commit/8a9d97d4a1da35554c9fe81cc4ef665b5d4415f1 title="Last modified by tshak | April 27, 2021" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>April 27, 2021</span></a></div><div><a class="flex align-center" href=https://github.com/riserplatform/docs/edit/main//docs/internals/gitops.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#the-state-repo>The State Repo</a><ul><li><a href=#environments-and-branches>Environments and Branches</a></li><li><a href=#folder-structure>Folder Structure</a></li></ul></li></ul></nav></aside></main></body></html>