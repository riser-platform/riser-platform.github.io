<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Secrets #  A Secret allows you to manage the lifecyle of sensitive information inside of Riser. Riser takes advantage of Public Key Infrastructure to provide a mechanism that allows for the secure management of sensitive values within a GitOps environment.
To learn more about the architecture of this feature, review the Secrets Internals section.
ℹ️ Other than a brief moment during the encryption phase, Riser does not have access to your Secrets."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="Secrets #  A Secret allows you to manage the lifecyle of sensitive information inside of Riser. Riser takes advantage of Public Key Infrastructure to provide a mechanism that allows for the secure management of sensitive values within a GitOps environment.
To learn more about the architecture of this feature, review the Secrets Internals section.
ℹ️ Other than a brief moment during the encryption phase, Riser does not have access to your Secrets."><meta property="og:type" content="article"><meta property="og:url" content="https://docs.riser.dev/docs/concepts/secrets/"><meta property="article:modified_time" content="2020-07-31T11:58:34+02:00"><title>Secrets | Riser Platform</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY="><script defer src=/en.search.min.3b26788883aaa6da97ae44247c6d81733498c568039fe8001d4a3c38fa85e103.js integrity="sha256-OyZ4iIOqptqXrkQkfG2BczSYxWgDn+gAHUo8OPqF4QM="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><img src=/logo.png alt=Logo><span>Riser Platform</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/quickstart/>Quickstart</a><ul></ul></li><li><span>Concepts</span><ul><li><a href=/docs/concepts/apps/>Apps</a></li><li><a href=/docs/concepts/deployments/>Deployments</a></li><li><a href=/docs/concepts/environments/>Environments</a></li><li><a href=/docs/concepts/namespaces/>Namespaces</a></li><li><a href=/docs/concepts/secrets/ class=active>Secrets</a></li><li><a href=/docs/concepts/url_routing/>Url Routing</a></li></ul></li><li><span>Guidance</span><ul><li><a href=/docs/guidance/docker/>Docker</a></li></ul></li><li><a href=/docs/internals/>Internals</a><ul><li><a href=/docs/internals/gitops/>Gitops</a></li><li><a href=/docs/internals/secrets/>Secrets</a></li></ul></li><li><a href=/docs/operations/>Internals</a><ul></ul></li></ul><ul><li><a href=https://github.com/riser-platform/riser target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Secrets</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#saving-a-secret>Saving a Secret</a></li><li><a href=#accessing-secrets-from-your-app>Accessing Secrets from your App</a></li><li><a href=#secret-revisions>Secret Revisions</a><ul><li><a href=#advanced-example>Advanced Example</a></li></ul></li><li><a href=#deleting-a-secret>Deleting a Secret</a></li></ul></nav></aside></header><article class=markdown><h1 id=secrets>Secrets
<a class=anchor href=#secrets>#</a></h1><p>A <em>Secret</em> allows you to manage the lifecyle of sensitive information inside of Riser. Riser takes advantage of <a href=https://en.wikipedia.org/wiki/Public_key_infrastructure>Public Key Infrastructure</a> to provide a mechanism that allows for the secure management of sensitive values within a GitOps environment.</p><p>To learn more about the architecture of this feature, review the <a href=/docs/internals/secrets/>Secrets Internals</a> section.</p><blockquote class="book-hint info">ℹ️ <em>Other than a brief moment during the encryption phase, Riser does not have access to your Secrets. Riser does not need access to your secrets or your private keys on your Kubernetes clusters.</em></blockquote><h2 id=saving-a-secret>Saving a Secret
<a class=anchor href=#saving-a-secret>#</a></h2><p>There are some important considerations to consider when using this feature:</p><ul><li><em>Secrets</em> are stored per <em>App</em> and per <em>Environment</em></li><li><em>Secrets</em> may not be shared between <em>Apps</em> or <em>Environments</em></li><li>For security reasons, there is intentionally no mechanism to read or copy a <em>Secret</em></li><li>You should not consider Riser <em>Secrets</em> as the canonical store for sensitive information</li></ul><p>Use <code>riser secrets save (name) (plaintextsecret) (targetEnvironment)</code> from inside your app folder to save a secret. For example, to save a postgres URL to the <code>dev</code> environment:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>riser secrets save POSTGRES_URL <span style=color:#e6db74>&#34;postgres://user:s3cr3t@postgres.net/mydb&#34;</span> dev
</code></pre></div><p>You should now see your secret using the command <code>riser secrets list (environment)</code></p><h2 id=accessing-secrets-from-your-app>Accessing Secrets from your App
<a class=anchor href=#accessing-secrets-from-your-app>#</a></h2><p>Once one or more <em>Secrets</em> are saved to an <em>Environment</em>, they are automatically bound to your <em>App</em> on each subsequent <a href=/docs/concepts/deployments/#creating-a-deployment>Deployment</a> in that <em>Environment</em>. <em>Secrets</em> are securely bound to your app using environment variables. For example, a <em>Secret</em> named <code>POSTGRES_URL</code> is bound to the environment variable <code>POSTGRES_URL</code> in your app.</p><h2 id=secret-revisions>Secret Revisions
<a class=anchor href=#secret-revisions>#</a></h2><p>When you wish to update a <em>Secret</em>, simply save a secret with the same name and a new value for the target <em>Environment</em> using <code>riser secrets save...</code>. Like saving a new <em>Secret</em>, the new value is not applied until after a
new <a href=/docs/concepts/deployments/#creating-a-deployment>Deployment</a> in that <em>Environment</em> takes place. Additionally, Riser will assign a revision number to the <em>Secret</em>. The <em>Secret Revision</em> is tied to your <a href=/docs/concepts/deployments/#revisions>Deployment&rsquo;s Revision</a>. This means that if you ever rollback your <em>Deployment</em> that your Secret values will rollback along with it.</p><h3 id=advanced-example>Advanced Example
<a class=anchor href=#advanced-example>#</a></h3><p>Most of the time it&rsquo;s just as simple as saving a <em>Secret</em> and creating a <em>Deployment</em>. The following is a more complex example where we save multiple revisions of the <em>Secret</em> and rollback our <em>Deployment</em>. Let&rsquo;s start with an <em>App</em> with no <em>Secrets</em> and we wish to save a secret <code>FOO</code> and access it from our code:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>riser secrets save FOO fooval1 dev
</code></pre></div><p><strong>Current State:</strong> The secret has been encrypted and saved in the <em>State Repo</em>, but the environment variable <code>FOO</code> does not exist until we create a new <em>Deployment</em> to the <code>dev</code> <em>Environment</em>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>riser deploy v1 dev
</code></pre></div><p><strong>Current State:</strong> The environment variable <code>FOO</code> now has the value <code>fooval1</code> in the <code>dev</code> <em>Environment</em>. The <em>Deployment</em> <em>Revision</em> is <code>2</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>riser secrets save FOO fooval2 dev
</code></pre></div><p><strong>Current State:</strong> The new secret value has been encrypted and saved in the <em>State Repo</em>. The environment variable <code>FOO</code> will still have the value <code>fooval1</code> until we create a new <em>Deployment</em> to the <code>dev</code> <em>Environment</em>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>riser deploy v1 dev
</code></pre></div><blockquote class="book-hint info">ℹ️ <em>It&rsquo;s okay to deploy the same Docker tag multiple times (e.g. <code>v1</code> in this example). Riser considers all configuration as code, including secrets. Riser will still create a new Deployment Revision even though you are deploying with the same Docker tag.</em></blockquote><p><strong>Current State:</strong> The environment variable <code>FOO</code> now has the value <code>fooval2</code> in the <code>dev</code> <em>Environment</em>. The <em>Deployment</em> <em>Revision</em> is <code>3</code>.</p><p>We&rsquo;ve discovered a problem with our <em>App</em> and we&rsquo;ve decided to rollback the <em>Deployment</em> back to <em>Revision</em> <code>2</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>riser rollout dev r2:100
</code></pre></div><p><strong>Current State:</strong> The environment variable <code>FOO</code> now has the value <code>fooval1</code> in the <code>dev</code> <em>Environment</em>. The <em>Deployment</em> <em>Revision</em> is <code>2</code>.</p><p>Riser always uses the most recent <em>Secret Revision</em> for a <em>Deployment</em>, regardless whether or not a rollback ocurred. If we were to redeploy our app again:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>riser deploy v1 dev
</code></pre></div><p><strong>Current State:</strong> The environment variable <code>FOO</code> now has the value <code>fooval2</code> in the <code>dev</code> <em>Environment</em>. The <em>Deployment</em> <em>Revision</em> is <code>4</code>.</p><blockquote class="book-hint info">ℹ️ <em>You never need to worry about the specific Secret Revisions. Riser manages which Deployment Revision maps to which Secret Revision for you so that you don&rsquo;t have to.</em></blockquote><h2 id=deleting-a-secret>Deleting a Secret
<a class=anchor href=#deleting-a-secret>#</a></h2><p>Deleting a <em>Secret</em> has not yet been implemented.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/riserplatform/docs/commit/4f669608408425016a8e0c7a420d678abbaaf3aa title="Last modified by tshak | July 31, 2020" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>July 31, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/riserplatform/docs/edit/main//docs/concepts/secrets.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#saving-a-secret>Saving a Secret</a></li><li><a href=#accessing-secrets-from-your-app>Accessing Secrets from your App</a></li><li><a href=#secret-revisions>Secret Revisions</a><ul><li><a href=#advanced-example>Advanced Example</a></li></ul></li><li><a href=#deleting-a-secret>Deleting a Secret</a></li></ul></nav></aside></main></body></html>